<html><head><title>toka.nbk: Lesson 3</title>
</head>
<body>


<p><b>toka.nbk:</b> <a href="home.html">Home</a> | <a href="index.html">Index</a> | Next Page: <a href="lesson_4.html">Lesson 4</a> | Previous Page: <a href="lesson_2.html">Lesson 2</a></p>

<hr>

<h1>&nbsp;Lesson 3</h1>


<h2>Review</h2>

<p>In the previous lesson we learned that: 
</p>
<ul>
<li> Toka words are described by stack diagrams like: ( argn .. arg0 --
  resultm .. result0 ) 
<li> Comments are either <b>( this is a comment )</b> or <b>#! the rest of the line is a comment</b>
<li> Both <b>(</b> and <b>#!</b> must be followed by whitespace 
<li> Comments work by executing a word that then explicitly calls the input parser 

</ul>

<h2>Arithmetic and Logical Operators</h2>

<p>We have already seen <b>+</b>, which pops two numbers, adds them, and
pushes the result. Here are some more numeric operators with their stack
diagrams:
</p>
<pre> +       ( n1 n2 -- n1+n2 )
 -       ( n1 n2 -- n1-n2 )
 *       ( n1 n2 -- n1*n2 )   \ Signed multiplication
 /       ( n1 n2 -- n1/n2 )   \ Signed division
 mod     ( n1 n2 -- n1%n2 )
 /mod    ( n1 n2 -- n1%n2 n1/n2 )
 and     ( n1 n2 -- n1&amp;n2 )
 or      ( n1 n2 -- n1|n2 )
 xor     ( n1 n2 -- n1^n2 )
 &lt;&lt;      ( n1 n2 -- n1&lt;&lt;n2 )  \ Shift bits left
 &gt;&gt;      ( n1 n2 -- n1&gt;&gt;n2 )  \ Shift bits right
 not     ( n -- ~n )          \ Bitwise logical inversion
 negate  ( n -- -n )          \ Arithmetic negation, i.e. 0-n
 1-      ( n -- n-1 )         \ Decrement by 1
 1+      ( n -- n+1 )         \ Increment by 1  
</pre>

<p>All of the above operators work on integers of the natural size for the
machine (32 bits on 32-bit processors). 
</p>
<h2>Using Toka as a Calculator</h2>

<p>Armed with those operators, plus the <b>.</b> (pop and display) word that
we have already seen, we can use Toka as an integer calculator. But since
everything is stack based, we have to use Reverse Polish instead of
algebraic syntax. Instead of writing down an algebraic expression with
parentheses to control the grouping, we have to think about what to do
first, and then do it.
</p>
<p>So, suppose that we want to calculate ( 5 + ( 4 * 7 ) ). The
multiplication has to be done first, before we can add the 5. We could
perform that calculation in Toka with:
</p>
<pre> 4 7 * 5 + .
</pre>

<p>Breaking this down into the individual steps, 
</p>

<ul>
<li> push 4 on the stack 
<li> push 7 on the stack 
<li> pop two items from the stack, multiply them, and push the result (28)
  back on the stack 
<li> push 5 on the stack 
<li> pop two items from the stack, add them, and push the result (33) back
  on the stack
<li> pop the stack and display it 

</ul>

<p>The same calculation can be written in a different way 
</p>
<pre> 5 4 7 * + .
</pre>

<p>In this version, we push all three numbers onto the stack at once, then
perform the arithmetic - first the multiplication of 4 and 7, and finally
the addition of 5 to the product.
</p>
<p>The key to using RPN is that you have to think in terms of doing steps in
order instead of writing a picture of the algebraic expression and
letting the compiler sort it out.
</p>
<h2>Stack Operators</h2>

<p>Sometimes you need to copy or rearrange the stack to bring items to the
correct position for further use. Four basic stack operators get the most
use. 
</p>
<pre> dup  ( a -- a a )
 drop ( a -- )
 swap ( a b -- b a )
 over ( a b -- a b a )
</pre>

<p>Stack operators will be examined in more detail in a later lesson. 
</p>
<p><i>Thus endeth the lesson</i></p>

<hr>

<p><b>toka.nbk:</b> <a href="home.html">Home</a> | <a href="index.html">Index</a> | Next Page: <a href="lesson_4.html">Lesson 4</a> | Previous Page: <a href="lesson_2.html">Lesson 2</a></p>

<hr>

<p><i>Notebook exported on Sunday, 17 June 2007, 16:25:55 PM EDT</i></p>

</body></html>

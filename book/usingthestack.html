<html><head><title>toka.nbk: UsingTheStack</title>
</head>
<body>


<p><b>toka.nbk:</b> <a href="home.html">Home</a> | <a href="index.html">Index</a> | Next Page: <a href="variables.html">Variables</a> | Previous Page: <a href="user_code.html">User Code</a></p>

<hr>

<h1>&nbsp;UsingTheStack</h1>


<p>he language makes use of a stack to pass data between functions (called
<i>quotes</i> in toka). Imagine a stack of blocks with numbers on them.
You can add or remove numbers from the top of the stack. You can also
rearrange the order of the numbers.
</p>
<p>The stack is initially empty. Let's start by putting some numbers on the
stack. Type in:
</p>
<pre>  23 7 9182
</pre>

<p>Excellent! Now print the number on top of the stack using <b>.</b>, which
is pronounced "dot". This is a hard word to write about in a manual
because it is just a single period.
</p>
<p>Enter:
</p>
<pre>  .
</pre>

<p>You should see the last number you entered, 9182, printed. Each time
<b>.</b> is used, the top element on the stack is lost. If you want to
see what is on the stack, you can use <b>:stack</b>. Try this:
</p>
<pre>  :stack
</pre>

<p>You should see:
</p>
<pre>  &lt;2&gt; 23 7
</pre>

<p>The number on the left, enclosed in brackets, is the number of items on
the stack. The number to the far right is the top of the stack, or
<i>TOS</i>. It should be mentioned that <b>:stack</b> leaves the stack
unchanged.
</p>
<p>Since Toka uses the stack to hold data being operated on, and it uses the
stack to pass data between quotes, it is very important to practice using
it. Quotes generally take what they need off of the stack, and put their
results back on it. To help understand exactly what each quote consumes
and leaves, we use <i>stack diagrams</i>. As an example:
</p>
<pre>  . ( x- )
</pre>

<p>That is to say, <b>.</b> takes one word off the stack (the 'x') and puts
nothing on the stack. In other words, it consumes the TOS.
</p>
<p>In the examples that follow, you do not need to type in the comments.
When you are programming, of course, liberal use of comments and stack
diagrams may make your code more readable and maintainable.
</p>
<p>Between examples, you may wish to clear the stack. If you enter
<b>reset</b>, the stack will be cleared. Since the stack is central to
Toka, it is important to be able to alter it easily. Let's look at some
more functions that manipulate the stack. Enter:
</p>
<pre>  reset
  777 dup :stack
</pre>

<p>You will notice that there are two copies of 777 on the stack. The quote
<b>dup</b> duplicates TOS. This is useful when you want to use the TOS
and still have a copy. The stack diagram for <b>dup</b> would be:
</p>
<pre>  dup ( x-xx )
</pre>

<p>Another useful quote is <b>swap</b>. Enter:
</p>
<pre>  reset
  23 7 :stack
  swap :stack
</pre>

<p>The stack should look like:
</p>
<pre>  &lt;2&gt; 7 23
</pre>

<p>The stack diagram for <b>swap</b> would be:
</p>
<pre>  swap ( xy-yx )
</pre>

<p>Now enter:
</p>
<pre>  over :stack
</pre>

<p>You should see:
</p>
<pre>  &lt;3&gt; 7 23 7
</pre>

<p><b>over</b> causes a copy of the second item on the stack to leapfrog
over the first. Its stack diagram would be:
</p>
<pre>  over ( xy-xyx )
</pre>

<p>Here is another commonly used function:
</p>
<pre>  drop ( x- )
</pre>

<p>Can you guess what we will see if we enter:
</p>
<pre>  drop :stack
</pre>

<p>Another handy function for manipulating the stack is <b>rot</b> (short
for rotate). Enter:
</p>
<pre>  11 22 33 44 :stack
  rot :stack
</pre>

<p>The stack diagram for <b>rot</b> is, therefore:
</p>
<pre>  rot ( xyz-yzx )
</pre>

<p>You have now learned the more important stack manipulation words. These
will be present in almost every non-trivial Toka program. I will say that
if you see heavy use of these words in your code, you may want to examine
and reorganize (<i>refactor</i>) your code. Use of variables and arrays
(which we will discuss later) can also help clean things up.
</p>
<p>Here are stack diagrams for some other useful stack manipulation
functions. Try experimenting with them by putting numbers on the stack
and calling them to get a feel for what they do. Again, the text in
parentheses is just a comment and need not be entered.
</p>
<pre>  2drop ( xyz--x )
  2dup ( xy-xyxy )
  nip ( xyz-xz )
  tuck ( xy-yxy )
</pre>


<hr>

<p><b>toka.nbk:</b> <a href="home.html">Home</a> | <a href="index.html">Index</a> | Next Page: <a href="variables.html">Variables</a> | Previous Page: <a href="user_code.html">User Code</a></p>

<hr>

<p><i>Notebook exported on Tuesday,  8 May 2007, 20:00:49 PM EDT</i></p>

</body></html>
